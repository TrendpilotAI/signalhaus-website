# SignalHaus Website — Code Audit

Generated by Judge Agent v2 (inline)

---

## Security

### HIGH: No Rate Limiting on /api/contact
**File:** `src/app/api/contact/route.ts`  
**Lines:** Full route — no rate limiting logic present  
**Issue:** Any bot can flood the form, causing Resend quota exhaustion and spam to Nathan's inbox.  
**Fix:** Add IP-based rate limiting (3 req / 15 min). See TODO 315.

### HIGH: Error Details Leaked to Client
**File:** `src/app/api/contact/route.ts`, line 51  
**Issue:** `details: text` from Resend error response is returned to the client. This could expose internal API error messages.  
**Fix:** Log internally, return generic `"Email delivery failed"` to client.

### HIGH: Error Details Leaked (catch block)
**File:** `src/app/api/contact/route.ts`, line 55  
**Issue:** `details: err.message` returned to client in catch block.  
**Fix:** Log `err.message`, return generic error to client.

### MEDIUM: No Input Length Validation
**File:** `src/app/api/contact/route.ts`, lines 13-16  
**Issue:** Checks only for presence, not length. A 1MB message field would be accepted.  
**Fix:** Add Zod validation with max lengths.

### MEDIUM: No CSP Headers
**File:** `next.config.ts`  
**Issue:** No Content-Security-Policy headers configured. Mitigates XSS risk.  
**Fix:** Add `headers()` in next.config.ts with CSP, X-Frame-Options, X-Content-Type-Options.

### LOW: npm audit
**Status:** npm audit returned no output (dependencies are minimal and recent). No known CVEs detected.

---

## Code Quality

### MEDIUM: Badge Images Are Text Placeholders
**File:** `src/app/page.tsx`, lines ~40-55 (badges section)  
**Issue:** Social proof badges rendered as `<div>` text elements instead of actual logo images. Looks unpolished.  
**Fix:** Replace with real SVG/PNG logos or a proper trusted-by section.

### MEDIUM: No `next/image` Usage
**Files:** `src/app/page.tsx`, all pages  
**Issue:** No images use `<Image>` from next/image. When real images are added, they won't be optimized.  
**Fix:** Use `<Image>` for all future image additions.

### MEDIUM: No ESLint Configuration
**File:** `package.json` — no `lint` script; no `.eslintrc.json`  
**Issue:** No static analysis. Type errors and code style issues can slip through.  
**Fix:** Add `next lint` script and `.eslintrc.json` with `next/core-web-vitals` ruleset.

### MEDIUM: Metadata Duplication Across Pages
**Files:** `src/app/*/page.tsx` (about, services, pricing, contact, blog)  
**Issue:** Each page repeats the full OG image URL, site name pattern, and base URL string.  
**Fix:** Create `src/lib/metadata.ts` with `baseMetadata` and `generatePageMetadata(title, desc, path)` helper.

### LOW: Unused `CONTACT_EMAIL` Fallback
**File:** `src/app/api/contact/route.ts`, line 3  
**Issue:** Falls back to `nathan@forwardlane.com` — a personal email — if env var not set. Should fail explicitly.  
**Fix:** Return 500 if `CONTACT_EMAIL` not configured, same as `RESEND_API_KEY` check.

### LOW: No `lint` or `format` Scripts in package.json
**File:** `package.json`  
**Issue:** Only `dev`, `build`, `start` scripts. Missing `lint`, `test`, `format`.

---

## Testing

### HIGH: Zero Test Coverage
**Issue:** No unit, integration, or E2E tests exist. Contact form, API route, and all pages are untested.  
**Fix:** See TODO 319 (Playwright E2E tests).

---

## Performance

### LOW: Font Loading Unknown
**File:** `src/app/layout.tsx`  
**Issue:** Need to verify fonts use `next/font` (not CDN) to avoid layout shift (CLS).  
**Check:** Run Lighthouse and verify CLS < 0.1.

### LOW: Static Sitemap
**File:** `public/sitemap.xml`  
**Issue:** Static file won't auto-update when new blog posts are added.  
**Fix:** Replace with `src/app/sitemap.ts` using Next.js built-in dynamic sitemap.

---

## SEO

### MEDIUM: No JSON-LD Structured Data
**Files:** All pages  
**Issue:** No Organization, Service, or Article schemas. Missing rich result eligibility.  
**Fix:** See TODO 317.

### MEDIUM: Blog Post Missing Article Schema
**File:** `src/app/blog/agentic-automation-future-of-gtm/page.tsx`  
**Issue:** Blog post has metadata but no Article JSON-LD schema. Reduces eligibility for Google article rich results.

### LOW: Internal Linking Sparse
**File:** Blog post page  
**Issue:** The one blog post doesn't link to /services or /pricing, missing SEO link equity flow.

---

## Accessibility

### MEDIUM: Badge Section Missing Semantic Markup
**File:** `src/app/page.tsx` (badges section)  
**Issue:** Badges use `role="img"` on a `<div>` but should use real `<img>` elements or be in a proper list.

### LOW: Mobile Navigation
**File:** `src/components/Header.tsx`  
**Issue:** Should verify hamburger/mobile menu works correctly on small screens. No mobile nav component visible in source.

---

## Summary Table

| Severity | Count | Top Issues |
|----------|-------|------------|
| HIGH | 3 | Rate limiting, error leakage (×2) |
| MEDIUM | 7 | CSP, no ESLint, metadata DRY, badges, no JSON-LD |
| LOW | 6 | Various polish items |

**Most critical immediate action:** Add rate limiting + fix error leakage in `/api/contact/route.ts` (TODO 315).
